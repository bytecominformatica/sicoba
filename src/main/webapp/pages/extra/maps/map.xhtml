<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf">


<ui:composition template="/layout.xhtml">
	<ui:define name="title">#{bundle.clientesmapa}</ui:define>
	<ui:define name="content">

		<div id="map-canvas" style="height: 500px; width: 700px"></div>

		<script type="text/javascript"
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQeWWcwyiqM226lNXNGrxp6u7hUoAWixI">
    	</script>
    	
		<script type="text/javascript">
	      function initialize() {

	    	  var myLatlng = new google.maps.LatLng(-3.758027, -38.652305);
	    	  var mapOptions = {
	    	    zoom: 15,
	    	    center: myLatlng
	    	  }
	    	  var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

	    	  
	    	  new google.maps.Marker({
	    	      position: myLatlng,
	    	      map: map,
	    	      title:"Bytecom",
	    	      icon: '../../../img/torre.png'
	    	  });

	    	  $.getJSON( "http://" + location.host + "/sicoba/rest/maps/clientesGeo", function( data ) {
	    		  var items = [];
	    		  $.each( data, function( key, val ) {
		    		  //var cliente = val.cliente;
	    			  var contentString = 
	    		    	  '<div id="content">'+
	    			          '<div id="siteNotice">'+
	    			          '</div>'+
	    			          
	    			          '<h4 id="firstHeading" class="firstHeading">'+
	    			          val.nome +
	    			          '</h4>'+
	    			          
	    			          '<div id="bodyContent">'+
	    				          '<label class="control-label">Endere√ßo:</label> ' + 
	    				          val.endereco.logradouro + ', ' +
	    				          val.endereco.numero + ', ' +
	    				          val.endereco.bairro.nome + ', ' +
	    				          val.endereco.bairro.cidade.nome + ', ' +
	    				          val.endereco.bairro.cidade.estado.uf + ', ' +
	    				          val.endereco.bairro.cidade.estado.pais.nome +
	    				          '<br/><label class="control-label">Fone:</label> ' + 
	    				          val.foneTitular +
	    				          '<br/><label class="control-label">Fone '+ val.contato+': </label> ' + 
	    				          val.foneContato +
	    			          '</div>'+
	    			          
	    		          '</div>';

		    		      var infowindow = new google.maps.InfoWindow({
		    		          content: contentString
		    		      });
	
			    		  
		    			  var marker = new google.maps.Marker({
		    	    	      position: new google.maps.LatLng(val.latitude, val.longitude),
		    	    	      map: map,
		    	    	      title:val.nome,
		    	    	      icon: '../../../img/'+ val.status +'.png'
		    	    	  });

		    			  google.maps.event.addListener(marker, 'click', function() {
		  	    		    infowindow.open(map,marker);
		  	    		  });
		    		  });
    		  });

	      }
	      google.maps.event.addDomListener(window, 'load', initialize);
	      
	    </script>
	</ui:define>
</ui:composition>
</html>